<!DOCTYPE html>
<html>
<head>
<title>Test Client</title>

<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>

<script src="js/lz-string-1.4.4.js"></script>

<script>

function createProject() {
    $.post("https://localhost:8000/project", { api_key: "75f5-4d53-b0f4" }, function(result){
        $("#project_id").html(`(${result.id})`);
        console.log(result);
    });
}

function getProjects() {
    $.get("https://localhost:8000/project", { api_key: "75f5-4d53-b0f4" }, function(result){
        $("#projects_count").html(`(${result.length})`);
        console.log(result);
    });
}

function renameProject() {
    var projGuid = $("#project_guid").val();
    var projName = $("#project_name").val();

    $.ajax({
        url: "https://localhost:8000/project/" + projGuid,
        data: { api_key: "75f5-4d53-b0f4", name: projName },
        dataType: "json",
        type: 'PUT',
        success: function(result) {
            console.log(result);
        },
        error: function(err) {
            console.error(err);
        }
    });
}

function deleteProject() {
    var projGuid = $("#project_guid").val();
    var projName = $("#project_name").val();

    $.ajax({
        url: "https://localhost:8000/project/" + projGuid,
        data: { api_key: "75f5-4d53-b0f4", name: projName },
        dataType: "json",
        type: 'DELETE',
        success: function(result) {
            console.log(result);
        },
        error: function(err) {
            console.error(err);
        }
    });
}

function sendSceneData() {
    var sceneData = {
        a: 100,
        b: 200,
        c: "Hello World!"
    };
    var sceneDataStr = JSON.stringify(sceneData);
    var compressedSceneData = LZString144.compressToBase64(sceneDataStr);

    $.post("http://localhost:8000/job", { api_key: "75f5-4d53-b0f4", compressed_scene_data: compressedSceneData }, function(result){
        // $("#project_id").html(`(${result.id})`);
        console.log("Server response: ", result);
    });
}

</script>
</head>
<body>

<button onclick="createProject()">Create project <span id="project_id"></span></button>

<input id="project_guid" placeholder="project guid">
<input id="project_name" placeholder="project name">
<button onclick="renameProject()">Rename project</span></button>
<button onclick="deleteProject()">Delete project</span></button>

<button onclick="getProjects()">Get projects <span id="projects_count"></span></button>

<button onclick="sendSceneData()">Send Scene Data<span id="send_scene_data"></span></button>

</body>
</html>